<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Member Dashboard</title>
    <script src="authenticate.js"></script> <!-- Authentication -->
</head>

<body>
    <h1>Welcome, Member</h1>
    <button onclick="logout()">Logout</button>

    <h2>Your Team</h2>
    <p id="userTeam"></p>

    <h2>Your Channels</h2>
    <ul id="userChannels"></ul>

    <script>
        async function loadUserTeam() {
            const response = await fetch("http://localhost:5000/user/team", {
                headers: { "Authorization": "Bearer " + localStorage.getItem("token") }
            });
            const data = await response.json();
            document.getElementById("userTeam").innerText = data.teamName || "Not assigned to a team.";
        }

        async function loadChannels() {
            const response = await fetch("http://localhost:5000/channels", {
                headers: { "Authorization": "Bearer " + localStorage.getItem("token") }
            });
            const data = await response.json();
            const channelList = document.getElementById("userChannels");
            channelList.innerHTML = "";
            data.forEach(channel => {
                const li = document.createElement("li");
                li.innerText = `#${channel.name} (Team: ${channel.team.name})`;
                channelList.appendChild(li);
            });
        }

        document.addEventListener("DOMContentLoaded", () => {
            loadUserTeam();
            loadChannels();
        });
    </script>

</body>

</html>